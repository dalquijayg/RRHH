<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Planillas Especiales - Recursos Humanos</title>
    <link rel="stylesheet" href="../Disenos/Reportes/ReportePlanillaEspecial.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- Header con logo y información del usuario -->
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <img src="../Imagenes/LogoDennis.png" alt="New Technology Logo" class="brand-logo">
                <div class="page-title">
                    <h1>Reporte de Planillas Especiales</h1>
                    <p>Sistema de Recursos Humanos</p>
                </div>
            </div>
            
            <div class="user-section">
                <div class="user-info">
                    <img src="../Imagenes/user-default.png" alt="Usuario" class="user-avatar" id="userAvatar">
                    <div class="user-details">
                        <span class="user-name" id="userName">Usuario</span>
                        <span class="user-role" id="userRole">Rol</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Contenedor principal -->
    <main class="main-container">
        <!-- Panel de filtros con resumen en línea -->
        <section class="filters-panel">
            <div class="filters-header">
                <h2><i class="fas fa-filter"></i> Filtros de Búsqueda</h2>
                
                <!-- Tarjetas de resumen en línea -->
                <div class="summary-cards-inline" id="summaryCardsInline" style="display: none;">
                    <div class="summary-card-inline">
                        <div class="card-icon-inline">
                            <i class="fas fa-file-invoice"></i>
                        </div>
                        <div class="card-content-inline">
                            <span class="card-number-inline" id="totalPlanillasInline">0</span>
                            <span class="card-label-inline">Planillas</span>
                        </div>
                    </div>
                    
                    <div class="summary-card-inline">
                        <div class="card-icon-inline">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="card-content-inline">
                            <span class="card-number-inline" id="totalColaboradoresInline">0</span>
                            <span class="card-label-inline">Colaboradores</span>
                        </div>
                    </div>
                    
                    <div class="summary-card-inline">
                        <div class="card-icon-inline quetzal-icon">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="card-content-inline">
                            <span class="card-number-inline" id="montoTotalInline">Q0.00</span>
                            <span class="card-label-inline">Monto Total</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="filters-content">
                <div class="filter-group">
                    <label for="fechaLaboral">
                        <i class="fas fa-calendar-alt"></i>
                        Fecha Laboral
                    </label>
                    <input type="date" id="fechaLaboral" class="form-input" required>
                </div>
                
                <div class="filter-group">
                    <label for="departamento">
                        <i class="fas fa-building"></i>
                        Departamento
                    </label>
                    <select id="departamento" class="form-select">
                        <option value="">Todos los departamentos</option>
                        <!-- Las opciones se cargarán dinámicamente -->
                    </select>
                </div>
                
                <div class="filter-actions">
                    <button type="button" class="btn btn-primary" id="btnBuscar">
                        <i class="fas fa-search"></i>
                        Buscar
                    </button>
                    <button type="button" class="btn btn-secondary" id="btnLimpiar">
                        <i class="fas fa-broom"></i>
                        Limpiar
                    </button>
                </div>
            </div>
        </section>

        <!-- Panel de resultados -->
        <section class="results-panel">
            <!-- Resumen de resultados original (oculto por CSS) -->
            <div class="results-summary" id="resultsSummary" style="display: none;">
                <div class="summary-cards">
                    <div class="summary-card">
                        <div class="card-icon">
                            <i class="fas fa-file-invoice"></i>
                        </div>
                        <div class="card-content">
                            <span class="card-number" id="totalPlanillas">0</span>
                            <span class="card-label">Planillas</span>
                        </div>
                    </div>
                    
                    <div class="summary-card">
                        <div class="card-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="card-content">
                            <span class="card-number" id="totalColaboradores">0</span>
                            <span class="card-label">Colaboradores</span>
                        </div>
                    </div>
                    
                    <div class="summary-card">
                        <div class="card-icon">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="card-content">
                            <span class="card-number" id="montoTotal">Q0.00</span>
                            <span class="card-label">Monto Total</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tabla de resultados -->
            <div class="results-table-container">
                <div class="table-header">
                    <h3><i class="fas fa-table"></i> Resultados de la Búsqueda</h3>
                </div>
                
                <!-- Estado inicial -->
                <div class="empty-state" id="emptyState">
                    <div class="empty-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <h3>Selecciona una fecha para comenzar</h3>
                    <p>Elige una fecha laboral y opcionalmente un departamento para ver las planillas especiales.</p>
                </div>

                <!-- Estado de carga -->
                <div class="loading-state" id="loadingState" style="display: none;">
                    <div class="loading-spinner">
                        <i class="fas fa-spinner fa-spin"></i>
                    </div>
                    <p>Cargando resultados...</p>
                </div>

                <!-- Estado sin resultados -->
                <div class="no-results-state" id="noResultsState" style="display: none;">
                    <div class="no-results-icon">
                        <i class="fas fa-inbox"></i>
                    </div>
                    <h3>No se encontraron resultados</h3>
                    <p>No hay planillas especiales para los filtros seleccionados.</p>
                </div>

                <!-- Tabla de datos -->
                <div class="table-wrapper" id="tableWrapper" style="display: none;">
                    <!-- Información de registros -->
                    <div class="table-info-bar">
                        <div id="infoRegistros" class="info-registros-container">
                            <!-- Se llenará dinámicamente -->
                        </div>
                    </div>
                    
                    <!-- Tabla con scroll -->
                    <div class="table-scroll-container">
                        <table class="results-table" id="resultsTable">
                            <thead>
                                <tr>
                                    <th class="sortable" data-column="correlativo">
                                        <i class="fas fa-hashtag"></i>
                                        Correlativo
                                        <i class="fas fa-sort sort-icon"></i>
                                    </th>
                                    <th class="sortable" data-column="nombreDepartamento">
                                        <i class="fas fa-building"></i>
                                        Departamento
                                        <i class="fas fa-sort sort-icon"></i>
                                    </th>
                                    <th class="sortable" data-column="descripcionLaboral">
                                        <i class="fas fa-tag"></i>
                                        Descripción
                                        <i class="fas fa-sort sort-icon"></i>
                                    </th>
                                    <th class="sortable" data-column="estado">
                                        <i class="fas fa-file-upload"></i>
                                        Estado Documento
                                        <i class="fas fa-sort sort-icon"></i>
                                    </th>
                                    <th class="sortable" data-column="cantColaboradores">
                                        <i class="fas fa-users"></i>
                                        Colaboradores
                                        <i class="fas fa-sort sort-icon"></i>
                                    </th>
                                    <th class="sortable" data-column="montoTotalGasto">
                                        <span style="font-weight: bold; color: #4CAF50;">Q</span>
                                        Monto Total
                                        <i class="fas fa-sort sort-icon"></i>
                                    </th>
                                    <th class="sortable" data-column="fechaHoraCreacion">
                                        <i class="fas fa-clock"></i>
                                        Fecha Creación
                                        <i class="fas fa-sort sort-icon"></i>
                                    </th>
                                    <th>
                                        <i class="fas fa-cogs"></i>
                                        Acciones
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                                <!-- Los datos se cargarán dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Controles de paginación -->
                    <div class="pagination-container">
                        <div id="paginacion" class="pagination-controls" style="display: none;">
                            <!-- Se llenará dinámicamente -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal para ver detalles de planilla -->
    <div class="modal" id="modalDetalle" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-eye"></i> Detalle de Planilla Especial</h3>
                <button type="button" class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body" id="modalBody">
                <!-- Información general de la planilla -->
                <div class="planilla-info">
                    <div class="info-section">
                        <h4>Información General</h4>
                        <div class="info-grid">
                            <div class="info-item">
                                <label>Correlativo:</label>
                                <span id="detalle-correlativo">-</span>
                            </div>
                            <div class="info-item">
                                <label>Departamento:</label>
                                <span id="detalle-departamento">-</span>
                            </div>
                            <div class="info-item">
                                <label>Descripción:</label>
                                <span id="detalle-tipo">-</span>
                            </div>
                            <div class="info-item">
                                <label>Fecha Laboral:</label>
                                <span id="detalle-fecha">-</span>
                            </div>
                            <div class="info-item">
                                <label>Monto Total:</label>
                                <span id="detalle-monto" class="amount">-</span>
                            </div>
                            <div class="info-item">
                                <label>Contiene Externos:</label>
                                <span id="detalle-externos">-</span>
                            </div>
                        </div>
                        
                        <div class="descripcion-section">
                            <label>Descripción Laboral:</label>
                            <p id="detalle-descripcion">-</p>
                        </div>
                    </div>
                </div>

                <!-- Nueva sección para información del documento -->
                <div class="documento-info-section" id="detalle-documento-info" style="display: none;">
                    <!-- El contenido se cargará dinámicamente -->
                </div>

                <!-- Detalle de colaboradores -->
                <div class="colaboradores-section">
                    <h4><i class="fas fa-users"></i> Colaboradores</h4>
                    <div class="colaboradores-table-wrapper">
                        <table class="colaboradores-table">
                            <thead>
                                <tr>
                                    <th>Colaborador</th>
                                    <th>Puesto</th>
                                    <th class="text-right">Monto</th>
                                </tr>
                            </thead>
                            <tbody id="detalleColaboradores">
                                <!-- Se cargarán dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="btnCerrarModal">
                    Cerrar
                </button>
            </div>
        </div>
    </div>

    <!-- Overlay del modal -->
    <div class="modal-overlay" id="modalOverlay" style="display: none;"></div>

    <script src="../Logica/Reportes/ReportePlanillaEspecial.js"></script>
</body>
</html>